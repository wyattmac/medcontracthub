# Test info

- Name: Enhanced Critical User Journey - E2E >> Complete User Journey with Enhanced Reliability
- Location: /home/locklearwyatt/projects/medcontracthub/__tests__/e2e/enhanced-critical-journey.test.ts:98:7

# Error details

```
Error: expect(received).toBeLessThan(expected)

Expected: < 10000
Received:   11703
    at /home/locklearwyatt/projects/medcontracthub/__tests__/e2e/enhanced-critical-journey.test.ts:278:50
```

# Page snapshot

```yaml
- link "MedContractHub":
  - /url: /dashboard
- navigation:
  - link "Dashboard":
    - /url: /dashboard
  - link "Opportunities":
    - /url: /opportunities
  - link "Saved":
    - /url: /saved
  - link "Proposals":
    - /url: /proposals
  - link "Analytics":
    - /url: /analytics
  - link "Settings":
    - /url: /settings
- paragraph: Developer Mode
- paragraph: Authenticated User
- banner:
  - link "Home":
    - /url: /dashboard
  - text: Opportunities
  - button "Quick Actions"
- main:
  - heading "Search & Filters" [level=3]
  - button
  - paragraph: Refine your opportunity search with advanced filters
  - text: Search
  - textbox "Search"
  - button "Search"
  - text: Medical Industry (NAICS)
  - combobox: All Medical Industries
  - text: State
  - combobox: All States
  - text: Status
  - combobox: Active
  - text: Set-Aside Type
  - combobox: All Opportunities
  - text: Response Deadline From
  - textbox "Response Deadline From"
  - text: Response Deadline To
  - textbox "Response Deadline To"
  - text: Quick Medical Filters
  - button "Medical Equipment"
  - button "Pharmaceuticals"
  - button "Hospital Services"
  - button "Closing in 30 Days"
  - button "Small Business Set-Asides"
  - heading "ðŸ” Federal Contract Opportunities" [level=1]
  - paragraph:
    - text: Live federal medical supply contracts from
    - strong: SAM.gov
    - text: tailored to your capabilities. Real-time data powered by AI matching for optimal results.
  - text: SAM.gov API Active 24K+ Opportunities AI-Powered Matching
  - heading "Active Opportunities" [level=3]
  - text: 1,247 +84 new this week
  - heading "Expiring This Week" [level=3]
  - text: "23"
  - paragraph: Response deadlines ending
  - heading "Total Contract Value" [level=3]
  - text: $2.4B
  - paragraph: "Avg: $1.9M per contract"
  - heading "Match Quality" [level=3]
  - text: "High 156 Medium 342 Low 749 API Quota: 756 remaining 23,300 opportunities foundVirtual scrolling enabled"
  - button "Export (23300)"
  - button
  - button "Switch to standard list"
  - button "Refresh"
  - text: 80% Match Excellent Match
  - link "6515--761-25-2-014-0168 -Chelmsford CMOP MED/SURGE ITEMS -(VA-25-00058679)":
    - /url: /opportunities/f9a2c47e-db1c-491a-bb87-6db43beb9f4c
    - heading "6515--761-25-2-014-0168 -Chelmsford CMOP MED/SURGE ITEMS -(VA-25-00058679)" [level=3]
  - paragraph: https://api.sam.gov/prod/opportunities/v1/noticedesc?noticeid=c0ce0e0e1ed247279eeb17f435f05e47
  - button
  - link "View on SAM.gov":
    - /url: https://sam.gov/opp/c0ce0e0e1ed247279eeb17f435f05e47/view
  - paragraph: Agency
  - paragraph: VETERANS AFFAIRS, DEPARTMENT OF.VETERANS AFFAIRS, DEPARTMENT OF.NATIONAL CMOP OFFICE (36C770)
  - paragraph: Deadline
  - paragraph: Jun 13, 2025, 4:00 PM
  - text: 7d NAICS 325413 SBA 36C77025Q0198 Active 40% Match Fair Match
  - link "USNA SERVERS":
    - /url: /opportunities/0d78e109-dbf7-4ea4-9493-5df87f523d22
    - heading "USNA SERVERS" [level=3]
  - paragraph: https://api.sam.gov/prod/opportunities/v1/noticedesc?noticeid=c3863cd778784acba82193897d950f91
  - button
  - link "View on SAM.gov":
    - /url: https://sam.gov/opp/c3863cd778784acba82193897d950f91/view
  - paragraph: Agency
  - paragraph: DEPT OF DEFENSE.DEPT OF THE NAVY.NAVSUP.NAVSUP GLOBAL LOGISTICS SUPPORT.NAVSUP FLC NORFOLK.NAVSUP FLT LOG CTR NORFOLK
  - paragraph: Location
  - paragraph: Annapolis, Maryland
  - paragraph: Deadline
  - paragraph: Jun 9, 2025, 11:59 PM
  - text: 4d NAICS 334111 SBA N0018925Q0310 Active 40% Match Fair Match
  - link "AFE CHIP":
    - /url: /opportunities/b9173fa9-a962-4328-a48b-332ee2fddcaa
    - heading "AFE CHIP" [level=3]
  - paragraph: https://api.sam.gov/prod/opportunities/v1/noticedesc?noticeid=c142a7d43534493b9b77bcc1df221339
  - button
  - link "View on SAM.gov":
    - /url: https://sam.gov/opp/c142a7d43534493b9b77bcc1df221339/view
  - paragraph: Agency
  - paragraph: ENERGY, DEPARTMENT OF.ENERGY, DEPARTMENT OF.FERMILAB - DOE CONTRACTOR
  - paragraph: Location
  - paragraph: Batavia, Illinois
  - paragraph: Deadline
  - paragraph: Jun 24, 2025, 5:00 PM
  - text: 18d NAICS 334413 NONE 370216 Active 40% Match Fair Match
  - link "Sources Sought Market Survey - Coordinate Measuring System & Reverse Engineering and Quality Control Kit, Mike Monroney Aeronautical Center (FAA), Oklahoma City OK.":
    - /url: /opportunities/b8039a44-9a85-455a-987d-cfd0069a6b75
    - heading "Sources Sought Market Survey - Coordinate Measuring System & Reverse Engineering and Quality Control Kit, Mike Monroney Aeronautical Center (FAA), Oklahoma City OK." [level=3]
  - paragraph: https://api.sam.gov/prod/opportunities/v1/noticedesc?noticeid=e0f873786f8c44c6bfd28dca0691e11f
  - button
  - link "View on SAM.gov":
    - /url: https://sam.gov/opp/e0f873786f8c44c6bfd28dca0691e11f/view
  - paragraph: Agency
  - paragraph: TRANSPORTATION, DEPARTMENT OF.FEDERAL AVIATION ADMINISTRATION.6973GH FRANCHISE ACQUISITION SVCS
  - paragraph: Deadline
  - paragraph: Jun 27, 2025, 1:00 PM
  - text: 21d NAICS 333517 NONE AC-25-02322_Complete_Coordinate_Measuring_System Active 10% Match Low Match
  - link "Sources Sought - NNSY Calibration & Repair IDIQ":
    - /url: /opportunities/f7826cec-9be7-40ed-b1d0-dc0d77cb6c37
    - heading "Sources Sought - NNSY Calibration & Repair IDIQ" [level=3]
  - paragraph: https://api.sam.gov/prod/opportunities/v1/noticedesc?noticeid=d6b658525e7a4e6db4cbe89c591523d3
  - button
  - link "View on SAM.gov":
    - /url: https://sam.gov/opp/d6b658525e7a4e6db4cbe89c591523d3/view
  - paragraph: Agency
  - paragraph: DEPT OF DEFENSE.DEPT OF THE NAVY.NAVSEA.NAVSEA SHIPYARD.NORFOLK NAVAL SHIPYARD GF
  - paragraph: Location
  - paragraph: Virginia
  - paragraph: Deadline
  - paragraph: Jun 12, 2025, 12:00 PM
  - text: 6d NAICS 811210 NNSY-137-0008 Active 30% Match Low Match
  - link "Protein Sequencing (PROSE) Industry Day":
    - /url: /opportunities/3795d540-ad5d-4a3c-b590-5b71c181d5d2
    - heading "Protein Sequencing (PROSE) Industry Day" [level=3]
  - paragraph: https://api.sam.gov/prod/opportunities/v1/noticedesc?noticeid=c59a9ba45a0f4761bb67175d8b4a7ba1
  - button
  - link "View on SAM.gov":
    - /url: https://sam.gov/opp/c59a9ba45a0f4761bb67175d8b4a7ba1/view
  - paragraph: Agency
  - paragraph: DEPT OF DEFENSE.DEFENSE ADVANCED RESEARCH PROJECTS AGENCY (DARPA).DEF ADVANCED RESEARCH PROJECTS AGCY
  - paragraph: Deadline
  - paragraph: Jun 23, 2025, 1:00 PM
  - text: 17d NAICS 541715 DARPA-SN-25-82 Active Showing 1 to 25 of 23,300 opportunities
  - button "Previous" [disabled]
  - button "1"
  - button "2"
  - button "3"
  - text: ...
  - button "932"
  - button "Next"
  - heading "âœ… SAM.gov Integration Active" [level=3]
  - paragraph: Successfully connected to SAM.gov API. Displaying live federal contract opportunities with real-time updates and AI-powered matching based on your NAICS codes.
  - text: Auto-sync enabled Real-time matching
- button "Open Tanstack query devtools":
  - img
- region "Notifications alt+T"
- alert
- button "Open Next.js Dev Tools":
  - img
```

# Test source

```ts
  178 |       
  179 |       await takeScreenshot(page, '04-opportunities', 'Opportunities Page')
  180 |       
  181 |       // Verify opportunities page elements
  182 |       const pageContent = await page.textContent('body')
  183 |       const hasOpportunities = pageContent.includes('Opportunities') || 
  184 |                               pageContent.includes('opportunities') ||
  185 |                               pageContent.includes('Search') ||
  186 |                               pageContent.includes('Medical')
  187 |       
  188 |       expect(hasOpportunities).toBe(true)
  189 |       console.log(`â±ï¸ Opportunities page loaded in ${performanceMetrics.opportunitiesLoad}ms`)
  190 |     })
  191 |
  192 |     // ===== STEP 4: SEARCH FUNCTIONALITY =====
  193 |     await test.step('Search Functionality', async () => {
  194 |       console.log('ðŸ“ Step 4: Testing Search Functionality')
  195 |       
  196 |       // Look for search input
  197 |       const searchSelectors = [
  198 |         'input[placeholder*="search"]',
  199 |         'input[name="search"]',
  200 |         'input[name="q"]',
  201 |         '[data-testid="search-input"]',
  202 |         'input[type="search"]'
  203 |       ]
  204 |       
  205 |       let searchInput = null
  206 |       for (const selector of searchSelectors) {
  207 |         const element = page.locator(selector)
  208 |         if (await element.isVisible({ timeout: 3000 })) {
  209 |           searchInput = element
  210 |           break
  211 |         }
  212 |       }
  213 |       
  214 |       if (searchInput) {
  215 |         performanceMetrics.searchResponse = await measurePerformance(page, async () => {
  216 |           await searchInput.fill('medical equipment')
  217 |           await page.keyboard.press('Enter')
  218 |           await waitForPageLoad(page)
  219 |         })
  220 |         
  221 |         await takeScreenshot(page, '05-search-results', 'Search Results')
  222 |         console.log(`â±ï¸ Search completed in ${performanceMetrics.searchResponse}ms`)
  223 |       } else {
  224 |         console.log('âš ï¸ Search input not found - skipping search test')
  225 |       }
  226 |     })
  227 |
  228 |     // ===== STEP 5: NAVIGATION TEST =====
  229 |     await test.step('Navigation and Page Transitions', async () => {
  230 |       console.log('ðŸ“ Step 5: Testing Navigation')
  231 |       
  232 |       const navigationTargets = [
  233 |         { url: '/dashboard', name: 'Dashboard' },
  234 |         { url: '/analytics', name: 'Analytics' },
  235 |         { url: '/proposals', name: 'Proposals' },
  236 |         { url: '/settings', name: 'Settings' }
  237 |       ]
  238 |       
  239 |       for (const target of navigationTargets) {
  240 |         try {
  241 |           await safeNavigate(page, `${baseURL}${target.url}`)
  242 |           await takeScreenshot(page, `06-nav-${target.name.toLowerCase()}`, target.name)
  243 |           console.log(`âœ… ${target.name} page accessible`)
  244 |         } catch (error) {
  245 |           console.log(`âš ï¸ ${target.name} page not accessible: ${error.message}`)
  246 |         }
  247 |       }
  248 |     })
  249 |
  250 |     // ===== STEP 6: MOBILE RESPONSIVENESS =====
  251 |     await test.step('Mobile Responsiveness', async () => {
  252 |       console.log('ðŸ“ Step 6: Testing Mobile Responsiveness')
  253 |       
  254 |       // Test mobile viewport
  255 |       await page.setViewportSize({ width: 375, height: 812 }) // iPhone X
  256 |       await safeNavigate(page, `${baseURL}/opportunities`)
  257 |       await takeScreenshot(page, '07-mobile-view', 'Mobile View')
  258 |       
  259 |       // Test tablet viewport
  260 |       await page.setViewportSize({ width: 768, height: 1024 }) // iPad
  261 |       await takeScreenshot(page, '08-tablet-view', 'Tablet View')
  262 |       
  263 |       // Restore desktop viewport
  264 |       await page.setViewportSize({ width: 1920, height: 1080 })
  265 |       console.log('âœ… Mobile responsiveness tested')
  266 |     })
  267 |
  268 |     // ===== PERFORMANCE SUMMARY =====
  269 |     console.log('\nðŸ“Š Performance Summary:')
  270 |     console.log(`ðŸ  Landing Page: ${performanceMetrics.landingPageLoad}ms`)
  271 |     console.log(`ðŸ›ï¸ Dashboard: ${performanceMetrics.dashboardLoad}ms`)
  272 |     console.log(`ðŸ” Opportunities: ${performanceMetrics.opportunitiesLoad}ms`)
  273 |     console.log(`âš¡ Search: ${performanceMetrics.searchResponse}ms`)
  274 |     
  275 |     // Validate performance with realistic thresholds
  276 |     expect(performanceMetrics.landingPageLoad).toBeLessThan(TEST_CONFIG.performance.landingPageMax)
  277 |     expect(performanceMetrics.dashboardLoad).toBeLessThan(TEST_CONFIG.performance.dashboardLoadMax)
> 278 |     expect(performanceMetrics.opportunitiesLoad).toBeLessThan(TEST_CONFIG.performance.opportunitiesPageMax)
      |                                                  ^ Error: expect(received).toBeLessThan(expected)
  279 |     
  280 |     if (performanceMetrics.searchResponse > 0) {
  281 |       expect(performanceMetrics.searchResponse).toBeLessThan(TEST_CONFIG.performance.searchResponseMax)
  282 |     }
  283 |     
  284 |     console.log('ðŸŽ‰ Enhanced Critical User Journey Test Completed Successfully!')
  285 |   })
  286 |
  287 |   test('API Health and Error Handling', async ({ page }) => {
  288 |     console.log('ðŸ”¬ Testing API Health and Error Handling...')
  289 |     
  290 |     await test.step('Health Endpoint Verification', async () => {
  291 |       const response = await page.request.get(`${baseURL}/api/health`)
  292 |       expect(response.status()).toBe(200)
  293 |       
  294 |       const healthData = await response.json()
  295 |       expect(healthData.status).toBe('healthy')
  296 |       console.log('âœ… Health endpoint working correctly')
  297 |     })
  298 |
  299 |     await test.step('Protected Endpoint Authentication', async () => {
  300 |       const response = await page.request.get(`${baseURL}/api/opportunities/search`)
  301 |       // Should require authentication
  302 |       expect([401, 403]).toContain(response.status())
  303 |       console.log('âœ… Protected endpoints properly secured')
  304 |     })
  305 |
  306 |     await test.step('Error Page Handling', async () => {
  307 |       // Test 404 page
  308 |       await safeNavigate(page, `${baseURL}/nonexistent-page`)
  309 |       const pageContent = await page.textContent('body')
  310 |       
  311 |       const hasErrorHandling = pageContent.includes('404') || 
  312 |                               pageContent.includes('Not Found') ||
  313 |                               pageContent.includes('Page not found')
  314 |       
  315 |       expect(hasErrorHandling).toBe(true)
  316 |       console.log('âœ… 404 error handling working')
  317 |     })
  318 |   })
  319 |
  320 |   test('Data Integrity and Security', async ({ page }) => {
  321 |     console.log('ðŸ›¡ï¸ Testing Data Integrity and Security...')
  322 |     
  323 |     await test.step('XSS Protection Test', async () => {
  324 |       await safeNavigate(page, `${baseURL}/opportunities`)
  325 |       
  326 |       // Test XSS protection
  327 |       const searchInput = page.locator('input[placeholder*="search"], input[name="search"]').first()
  328 |       
  329 |       if (await searchInput.isVisible({ timeout: 5000 })) {
  330 |         const xssPayload = '<script>alert("xss")</script>'
  331 |         await searchInput.fill(xssPayload)
  332 |         await page.keyboard.press('Enter')
  333 |         await waitForPageLoad(page)
  334 |         
  335 |         // Verify XSS was blocked
  336 |         const pageContent = await page.textContent('body')
  337 |         expect(pageContent).not.toContain('<script>')
  338 |         console.log('âœ… XSS protection working')
  339 |       }
  340 |     })
  341 |
  342 |     await test.step('SQL Injection Protection Test', async () => {
  343 |       await safeNavigate(page, `${baseURL}/opportunities`)
  344 |       
  345 |       const searchInput = page.locator('input[placeholder*="search"], input[name="search"]').first()
  346 |       
  347 |       if (await searchInput.isVisible({ timeout: 5000 })) {
  348 |         const sqlPayload = "'; DROP TABLE opportunities; --"
  349 |         await searchInput.fill(sqlPayload)
  350 |         await page.keyboard.press('Enter')
  351 |         await waitForPageLoad(page)
  352 |         
  353 |         // Page should still be functional
  354 |         const pageContent = await page.textContent('body')
  355 |         expect(pageContent).not.toContain('error')
  356 |         expect(pageContent).not.toContain('500')
  357 |         console.log('âœ… SQL injection protection working')
  358 |       }
  359 |     })
  360 |   })
  361 | })
```